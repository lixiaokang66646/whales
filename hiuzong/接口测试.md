### 一、接口测试的原理

通过测试程序或工具模拟客户端向服务器发送请求报文，服务器接收请求报文后对相应的报文做出处理然后再把应答报文发送给客户端，客户端接收应答报文这一过程（request→response）

接口测试常用工具：postman，jmeter （现在主流的两个测试接口工具）

### 二、为什么做接口测试？

1.更早地发现问题： 测试应该更早地介入到项目开发中，因为越早地发现bug，修复的成本越低。然而功能测试必须等到系统提供可测试的界面才能对系统进行测试。而接口测试可以在功能界面开发出来之前对系统进行测试。系统接口是上层功能的基础，接口测试可以更早更低成本地发现和解决问题。

2.缩短产品研发周期： 对于产品研发周期来说，如果将所有测试工作都集中在功能测试阶段，那么测试的问题和修复周期就会变长。因为测试可以更早地介入产品开发中，所以，可以有效地控制功能阶段bug的数量；从而有效地缩短产品开发周期。

3.发现更底层的问题： 系统的有些底层逻辑是在UI功能测试中不太容易触发的，那么这些逻辑可能会存在问题。接口测试可以更容易更全面的测试到这些底层的逻辑。

4.检查服务器的异常处理能力： 我们通常把前端的验证称为弱验证，因为它很容易被绕过，这个时候如果只站在功能的层面进行测试，就很难发现一些安全的问题。

### 三、接口分类

1. 接口分类 ：

   把接口分为两类：程序接口和协议接口。
   1.程序接口，也可以看作是程序模块接口，具体到程序中一般就是提供了输入输出的类、方法或函数。 对于程序接口的测试，一般需要使用与开发程序接口相同的编程语言，通过不同的传入不同的参数，来验证 程序接口的功能。
    2.协议接口，一般指系统通过不同的协议来提供的接口，例如 HTTP/SOAP 协议等。这种类型接口对 底层代码做了封装，通过协议的方式对外提供调用。因为不涉及到程序层面，所以，不受编程语言的限制； 我们可以通过其它编程语言或工具对其进行测试。

2.  接口大体可以分成三类：
    1.系统与系统之间的：系统与系统之间的接口，这里可以是公司内部不同系统之间的接口调用，也可以是不同公司之间系统接口的调用。而对于公司的其它系统，如社区网站和微信活动可以调用这些接口快速的实现相应的功能。而对于后者来说，如微信，微博所提供的第三方登录接口，如果你开发的系统不想自建用户体系，完全可以调用这些接口来实现用户的登录。
    2.下层服务对上层服务的接口应用层，从认知上你可以看成是系统所提供的 UI 层功能。对于 Web系统来说，你可以认为是浏览器页面上所提供的功能，登录、注册、查询、删除等。Service 层，可以理解为服务器所提供数据和逻辑的处理。DB 层，(Data Base) 数据库主要用来存放数据，例如用户的个人信息，商品的信息等。
    3.系统内，服务与服务之间的调用 假设系统开发一个用户查询接口，输入用户名，返回用户信息（性别、年龄、手机号、邮箱地址等），如果用户不存在则返回NULL；现在需要新开发一个用户抽奖的接口，该接口需要用户名和抽奖id，抽奖接口得到用户名后可以调用用户查询接口，如果用户查询接口返回NULL，那么投资接口就可以直接返回用户不存在了。在这个例子中，用户抽奖接口就调用的用户查询接口。

### 四、接口测试都要掌握哪些知识？

1.  了解系统及内部各个组件之间的业务逻辑交互；

2.  了解接口的I/O（input/output：输入输出）；

3.  了解协议的基本内容，包括：通信原理、三次握手、常用的协议类型、报文构成、数据传输方式、常见的状态码、URL构成等；

4.  常用的接口测试工具，比如：jmeter、loadrunner、postman、soapUI等；

5.  数据库基础操作命令（检查数据入库、提取测试数据等）；

6.  常见的字符类型，比如：char、varchar、text、int、float、datatime等；

### 五、接口测试数据准备：

接口测试的数据准备，可以从下面几个方面去考虑：

1、如果是只测试一次的接口，可以使用硬编码的方式准备测试数据，在写测试代码的时候，使用到什么数据就写什么数据，为了避免数据重复，可能比较多的会用到随机字符或随机数

2、可以直接通过调用其他API的方式准备测试数据，这种情况在测试最上层服务的时候比较有用，比如测试团购购买服务，就需要准备要购买的团购数据，购买团购的用户数据，这个时候，可以直接调用生产团购的api和生成用户的api直接生成测试数据

3、使用excel或xml准备测试数据，这种准备测试数据的方式，主要针对对象数据的准备，比如可以将一条团购数据对应excel中的一条数据，因为一般开发都会使用pojo映射，而在准备测试数据的时候，这些pojo对象属性的设置往往是重复和大工作量的，用excel或XML方式准备，则可以减少在代码当中重复去准备这些数据。

4、也可以使用工具方法的形式去准备测试数据，通过在代码中写工具方法去实现数据生成，而在测试代码中调用



**工具方法去得到所需数据接口测试的着眼点：**

1、检查接口返回的数据是否与预期的结果一致。

2、检查接口的容错性，假如传递数据的类型错误时是否可以处理。例如上面的例子是支持整数，传递的是小数或字符串呢？

3、接口参数的边界值。例如，传递的参数足够大或为负数时，接口是否可以正常处理。

4、接口的性能，接口处理数据的时间也是测试的一个方面。牵扯到内部就是算法与代码的优化。

5、接口的安全性，如果是外部接口的话，这点尤为重要。

**接口测试用例设计：**

接口测试用例的设计方法其实和功能测试用例的设计方法是类似的，因为接口是需要满足需求的，而接口测试所依赖的也是需求说明书，但是，因为接口测试毕竟是通过代码去测试代码，所以，为了保证覆盖率，可能会使用到单元测试的方法，具体的测试用例设计如下：输入参数测试：

1、针对输入的参数进行测试，也可以说是假定接口参数的不正确性进行的测试，确保接口对任意类型的输入都做了相应的处理：输入参数合法，输入参数不合法，输入参数为空，输入参数为null，输入参数超长；

2、功能测试：接口是否满足了所提供的功能，相当于是正常情况测试，如果一个接口功能复杂时推荐对接口用例进行结构划分，这样子用例具有更好的可读性和维护性；

 3、逻辑测试：逻辑测试严格讲应为单元测试，单元测试应保持内部逻辑的正确性，可单元测试和接口测试界限并不是那么清楚，所以我们也可以从给出的设计文档中考虑内部逻辑错误的分支情况和异常；

4、异常情况测试：接口实现是否对异常情况都进行了处理，接口输入参数虽然合法，但是在接口实现中，也会出现异常，因为内部的异常不一定是输入的数据造成的，而有可能是其他逻辑造成的，程序需要对任何的异常都进行处理。

### 六、接口测试流程

(1) 开发提供需求文档（接口文档应该包括完整的功能接口、接口请求方式、接口请求URL、接口请求参数、接口返回数据）

(2) 需求分析与评审

(3) 编写测试用例

(4) 搭建环境

(5) 执行测试用例

(6) bug提交与跟踪

(7) 回归测试

(8) 编写测试报告



## 七、接口用例设计



(1) 必需参数覆盖。对于接口的参数，接口文档一般都会说明哪些儿是必需的，哪儿是非必需的。对于必需的参数，一定要测试传参数和不传参数接口是否报错？

(2) 必需的参数各种情况覆盖。传非法的字符，特殊的字符，空值，超过边界的参数是否报错？错误信息是否正确？

(3) 非必需参数覆盖。一般接口对于非必需参数都不会做非正常性传值的判断，所以要测试合法的参数值 ，接口返回的内容是否正确。如果有接口文档说明对非必需参数做了非正常的验证的话，也要对其进行验证。

(4) 参数的组合覆盖。有些儿参数需要相互配合着才起作用，如"offset"和"count"组合起来进行翻页，这个时候要组合起来进行测试。

(5) 业务逻辑相关的覆盖。有些儿接口与业务逻辑关联密切，单独从接口角度测试，可能会遗漏掉一些儿因业务逻辑而产生的bug。所以如果和业务逻辑相关，也要考虑到业务逻辑相关的测试用例。

![IMG_256](media/image3.jpeg){width="5.71875in" height="2.4375in"}
